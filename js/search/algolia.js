window.addEventListener("load",()=>{const{algolia:t}=GLOBAL_CONFIG;const{appId:e,apiKey:i,indexName:o,hitsPerPage:r=5,languages:n}=t;if(!e||!i||!o){return console.error("Algolia setting is invalid!")}const s=document.getElementById("search-mask");const l=document.querySelector("#algolia-search .search-dialog");const a=t=>{const e=t?"animateIn":"animateOut";const i=t?"to_show 0.5s":"to_hide 0.5s";const a=t?"titleScale 0.5s":"search_close .5s";btf[e](s,i);btf[e](l,a)};const c=()=>{if(window.innerWidth<768){l.style.setProperty("--search-height",`${window.innerHeight}px`)}};const g=()=>{btf.overflowPaddingR.add();a(true);P(false);setTimeout(()=>{const t=document.querySelector("#algolia-search-input .ais-SearchBox-input");if(t)t.focus()},100);const e=t=>{if(t.code==="Escape"){d();document.removeEventListener("keydown",e)}};document.addEventListener("keydown",e);c();window.addEventListener("resize",c)};const d=()=>{btf.overflowPaddingR.remove();a(false);window.removeEventListener("resize",c)};const f=()=>{btf.addEventListenerPjax(document.querySelector("#search-button > .search"),"click",g)};const p=()=>{s.addEventListener("click",d);document.querySelector("#algolia-search .search-close-button").addEventListener("click",d)};const u=t=>{if(!t)return"";let e="";if(typeof t==="string"){e=t.trim()}else if(typeof t==="object"){if(t.value!==undefined){e=String(t.value).trim();if(!e)return""}else if(t.matchedWords||t.matchLevel||t.fullyHighlighted!==undefined){return""}else{try{e=JSON.stringify(t).trim();if(e==="{}"||e==="[]"||e==='""'){return""}}catch(t){return""}}}else if(t.toString&&typeof t.toString==="function"){e=t.toString().trim();if(e==="[object Object]"||e==="[object Array]"){return""}}else{return""}const i=e.indexOf("<mark>");let a=i-30;let n=i+120;let s="";let l="";if(a<=0){a=0;n=140}else{s="..."}if(n>e.length){n=e.length}else{l="..."}let o=e.substring(a,n);const r=o.indexOf(">");const c=o.indexOf("<");if(r!==-1&&(c===-1||r<c)){o=o.substring(r+1)}const g=o.lastIndexOf("<");const d=o.lastIndexOf(">");if(g!==-1&&g>d){o=o.substring(0,g)}const f=[];let p="";let u=0;while(u<o.length){if(o[u]==="<"){if(o[u+1]==="/"){const h=o.indexOf(">",u);if(h!==-1){const m=o.substring(u+2,h);for(let t=f.length-1;t>=0;t--){if(f[t]===m){f.splice(t,1);break}}p+=o.substring(u,h+1);u=h+1;continue}}else if(o.substr(u,2)==="<!"||o.indexOf("/>",u)!==-1&&o.indexOf("/>",u)<o.indexOf(">",u)){const y=o.indexOf(">",u);if(y!==-1){p+=o.substring(u,y+1);u=y+1;continue}}else{const y=o.indexOf(">",u);if(y!==-1){const P=o.substring(u+1,o.indexOf(" ",u)>-1&&o.indexOf(" ",u)<y?o.indexOf(" ",u):y).split(/\s/)[0];f.push(P);p+=o.substring(u,y+1);u=y+1;continue}}}p+=o[u];u++}while(f.length>0){const P=f.pop();p+=`</${P}>`}if(a>0||s){const b=e.indexOf("<",a>0?a-30:0);const w=e.indexOf("<mark>",a>0?a-30:0);if(b!==-1&&(w===-1||b<w)){s="..."}}o=p;return`${s}${o}${l}`};const h=t=>{if(!t)return"";if(typeof t==="string"){return t.trim()}if(typeof t==="object"&&t.value!==undefined){return String(t.value).trim()}return""};let m;if(window["algoliasearch/lite"]&&typeof window["algoliasearch/lite"].liteClient==="function"){m=window["algoliasearch/lite"].liteClient(e,i)}else if(typeof window.algoliasearch==="function"){m=window.algoliasearch(e,i)}else{return console.error("Algolia search client not found!")}if(!m){return console.error("Failed to initialize Algolia search client")}let y="";const P=t=>{const e=document.getElementById("loading-status");if(e){e.hidden=!t}};const b={get searchInput(){return document.querySelector("#algolia-search-input .ais-SearchBox-input")},get hits(){return document.getElementById("algolia-hits")},get hitsEmpty(){return document.getElementById("algolia-hits-empty")},get hitsList(){return document.querySelector("#algolia-hits .ais-Hits-list")},get hitsWrapper(){return document.querySelector("#algolia-hits .ais-Hits")},get pagination(){return document.getElementById("algolia-pagination")},get paginationList(){return document.querySelector("#algolia-pagination .ais-Pagination-list")},get stats(){return document.querySelector("#algolia-info .ais-Stats-text")}};const w=t=>{b.pagination.style.display=t?"":"none";b.stats.style.display=t?"":"none"};const v=(t,e,o=0)=>{if(t.length===0&&e){b.hitsEmpty.textContent=n.hits_empty.replace(/\$\{query}/,e);b.hitsEmpty.style.display="";b.hitsWrapper.style.display="none";b.stats.style.display="none";return}b.hitsEmpty.style.display="none";const i=t.map((t,e)=>{const i=o*r+e+1;const a=t.permalink||GLOBAL_CONFIG.root+t.path;const n=t._highlightResult||t;let s="";try{if(n.contentStripTruncate){s=u(n.contentStripTruncate)}else if(n.contentStrip){s=u(n.contentStrip)}else if(n.content){s=u(n.content)}else if(t.contentStripTruncate){s=u(t.contentStripTruncate)}else if(t.contentStrip){s=u(t.contentStrip)}else if(t.content){s=u(t.content)}}catch(t){s=""}let l="no-title";try{if(n.title){l=h(n.title)||"no-title"}else if(t.title){l=h(t.title)||"no-title"}if(!l||l==="no-title"){if(typeof t.title==="string"&&t.title.trim()){l=t.title.trim()}else if(t.title&&typeof t.title==="object"&&t.title.value){l=String(t.title.value).trim()||"no-title"}else{l="no-title"}}}catch(t){l="no-title"}return`
        <li class="ais-Hits-item" value="${i}">
          <a href="${a}" class="algolia-hit-item-link">
            <span class="algolia-hits-item-title">${l}</span>
            ${s?`<div class="algolia-hit-item-content">${s}</div>`:""}
          </a>
        </li>`}).join("");b.hitsList.innerHTML=i;b.hitsWrapper.style.display=e?"":"none";if(t.length>0){b.stats.style.display=""}};const x=(e,t)=>{if(t<=1){b.pagination.style.display="none";b.paginationList.innerHTML="";return}b.pagination.style.display="block";const i=e===0;const a=e===t-1;const n=window.innerWidth<768;const s=n?3:5;let l=Math.max(0,e-Math.floor(s/2));const o=Math.min(t-1,l+s-1);if(o-l+1<s){l=Math.max(0,o-s+1)}let r="";if(t>s&&l>0){r+=`
        <li class="ais-Pagination-item ais-Pagination-item--page">
          <a class="ais-Pagination-link" aria-label="Page 1" href="#" data-page="0">1</a>
        </li>`;if(l>1){r+=`
          <li class="ais-Pagination-item ais-Pagination-item--ellipsis">
            <span class="ais-Pagination-link">...</span>
          </li>`}}for(let t=l;t<=o;t++){const c=t===e;if(c){r+=`
          <li class="ais-Pagination-item ais-Pagination-item--page ais-Pagination-item--selected">
            <span class="ais-Pagination-link" aria-label="Page ${t+1}">${t+1}</span>
          </li>`}else{r+=`
          <li class="ais-Pagination-item ais-Pagination-item--page">
            <a class="ais-Pagination-link" aria-label="Page ${t+1}" href="#" data-page="${t}">${t+1}</a>
          </li>`}}if(t>s&&o<t-1){if(o<t-2){r+=`
          <li class="ais-Pagination-item ais-Pagination-item--ellipsis">
            <span class="ais-Pagination-link">...</span>
          </li>`}r+=`
        <li class="ais-Pagination-item ais-Pagination-item--page">
          <a class="ais-Pagination-link" aria-label="Page ${t}" href="#" data-page="${t-1}">${t}</a>
        </li>`}if(t>1){b.paginationList.innerHTML=`
            <li class="ais-Pagination-item ais-Pagination-item--previousPage ${i?"ais-Pagination-item--disabled":""}">
              ${i?'<span class="ais-Pagination-link ais-Pagination-link--disabled" aria-label="Previous Page"><i class="fas fa-angle-left"></i></span>':`<a class="ais-Pagination-link" aria-label="Previous Page" href="#" data-page="${e-1}"><i class="fas fa-angle-left"></i></a>`}
            </li>
            ${r}
            <li class="ais-Pagination-item ais-Pagination-item--nextPage ${a?"ais-Pagination-item--disabled":""}">
              ${a?'<span class="ais-Pagination-link ais-Pagination-link--disabled" aria-label="Next Page"><i class="fas fa-angle-right"></i></span>':`<a class="ais-Pagination-link" aria-label="Next Page" href="#" data-page="${e+1}"><i class="fas fa-angle-right"></i></a>`}
            </li>`;b.pagination.style.display=y?"":"none"}else{b.pagination.style.display="none"}};const S=(t,e,i)=>{if(i){const a=n.hits_stats.replace(/\$\{hits}/,t).replace(/\$\{time}/,e);b.stats.innerHTML=`<hr>${a}`;b.stats.style.display=""}else{b.stats.style.display="none"}};const k=async(e,i=0)=>{if(!e.trim()){y="";v([],"",0);x(0,0);S(0,0,"");w(false);return}P(true);y=e;try{let t;if(m&&typeof m.search==="function"){const s=await m.search([{indexName:o,query:e,params:{page:i,hitsPerPage:r,highlightPreTag:"<mark>",highlightPostTag:"</mark>",attributesToHighlight:["title","content","contentStrip","contentStripTruncate"]}}]);t=s.results[0]}else if(m&&typeof m.initIndex==="function"){const l=m.initIndex(o);t=await l.search(e,{page:i,hitsPerPage:r,highlightPreTag:"<mark>",highlightPostTag:"</mark>",attributesToHighlight:["title","content","contentStrip","contentStripTruncate"]})}else{throw new Error("Algolia: No compatible search method available")}v(t.hits||[],e,i);const a=t.nbHits<=r?1:t.nbPages||0;x(i,a);S(t.nbHits||0,t.processingTimeMS||0,e);const n=t.hits&&t.hits.length>0;w(n);if(window.pjax){window.pjax.refresh(document.getElementById("algolia-hits"))}}catch(t){console.error("Algolia search error:",t);v([],e,i);x(0,0);S(0,0,e)}finally{P(false)}};let $;const L=(t,e=300)=>{clearTimeout($);$=setTimeout(()=>k(t),e)};const E=()=>{P(false);if(b.searchInput){b.searchInput.addEventListener("input",t=>{const e=t.target.value;L(e)})}const t=document.querySelector("#algolia-search-input .ais-SearchBox-form");if(t){t.addEventListener("submit",t=>{t.preventDefault();const e=b.searchInput.value;k(e)})}b.pagination.addEventListener("click",t=>{t.preventDefault();const e=t.target.closest("a[data-page]");if(e){const i=parseInt(e.dataset.page,10);if(!isNaN(i)&&y){k(y,i)}}});w(false)};E();f();p();window.addEventListener("pjax:complete",()=>{if(!btf.isHidden(s))d();f()})});